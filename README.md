# Predicting Ammonia Plume Presence at Feedlots in the San Joaquin Valley from VSWIR Spectroscopy of the Land Surface
<img align = "left" src="https://science.nasa.gov/wp-content/uploads/2023/11/sarp-patch.jpeg?w=1280&format=webp" alt="drawing" width="200"/>As part of NASA's [Student Airborne Research Program (SARP)](https://science.nasa.gov/earth-science/early-career-opportunities/student-airborne-research-program/) in 2024, I had the oppourtunity to study remote sensing of feedlot ammonia emissions under the guidance of [Dr. Dan Sousa](https://geography.sdsu.edu/people/bios/sousa) and [Megan Ward-Baranyay](https://www.linkedin.com/in/mwardbaranyay/). This repository holds the code and essential data for my study, in which I correlated HyTES-detected plume presence with feedlot surface reflectance values from EMIT. 

The code folder holds the bulk of this project. The extraction scripts in this folder gneraly take geotiffs and geopackages of polygons and extract the raster stats from the geotiff for each polygon. The regresions script is used to run random forest and partial least squares regressors and classifiers on the resulting data, and the figure geenration script assists in presenting this data. The data folder holds geopkg and csv files from ArcGIS that contain information about the feedlot location (identified in NAIP and EMIT imagery) and emissions (identified in HyTES L3 trace gas products). It also holds raster information files that summarize spectral statistics of each feedlot, generated by the extraction scripts. The HyTES extraction code is specifically for converting HyTES data files (hdf5, hdr, and geo.dat) into geotiffs and was based entirely on code written by Dr. Madeleine Pascolini-Campbell for working with L2 products and kindly provided to me by Quentin Dehaene. I modified it to process batches of L3 gas data. Code in the Other folder was not used for the final project but was written for tangents. 

All code is rough and generally uncommented at this time, use with care. 

Aside from the hytesinputs and writegeotiff files which were written by Dr. Madeleine Pascolini-Campbell, all code is my own, though many portions were initially generated by ChatGPT. Many thanks to Disha Sardana, Megan Ward-Baranyay, and Dan Sousa for their advice and assistance. 

# Abstract
Industrial-scale livestock farms, or Concentrated Animal Feeding Operations (CAFOs), are a major source of air pollutants including ammonia, methane, and hydrogen sulfide. Ammonia in particular is a major contributor to rural air pollution that is released from the breakdown of livestock effluent. Mitigating regional air pollution through improved waste management practices is only possible if emissions can be accurately monitored. However, ammonia is challenging to measure directly due to its short atmospheric lifetime and lack of VSWIR spectral signature.

Here we investigate the potential for spectroscopic imaging of the CAFO land surface to predict the presence of detectable ammonia emissions. Data from the Hyperspectral Thermal Emission Spectrometer (HyTES) instrument were found to clearly identify plumes of ammonia emitted by specific feedlots. Plume presence or absence was then tied to pixel-level reflectance spectra  from the Earth Surface Mineral Dust Source (EMIT) instrument.  Random forest classification models were found to predict ammonia plume presence/absence from VSWIR reflectance alone with an accuracy in the range of 70% to 80%. Our conclusions are limited by the limited number of feedlots overflown by HyTES (n=96), the time gap between HyTES and EMIT data, and potential difficulty in comparing feedlots in different regions. 

While only tested over a modest area, our results suggest that ammonia plume presence/absence may be predictable on the basis of surface features identifiable from VSWIR reflectance alone. Further investigation could focus on more comprehensive model validation, including characterization of the land surface processes and spectral signatures associated with feedlot surfaces with and without observable ammonia plumes. If generalizable, these results suggest that EMIT data may in some circumstances be used to predict the presence of ammonia emission plumes at feedlots in other areas, potentially enabling broader accounting of feedlot ammonia emissions.
